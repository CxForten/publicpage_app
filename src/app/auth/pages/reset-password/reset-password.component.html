<div class="reset-password-wrapper">
  <div class="reset-password-container">
    <!-- Header con logo -->
    <div class="header-section">
      <img src="assets/icons/gaia.png" alt="Gaia Logo" class="logo"/>
      <h2>Restablecer Contraseña</h2>
    </div>

    <!-- Indicador de carga mientras se valida el token -->
    <div class="loading-section" *ngIf="loading">
      <div class="loading-spinner"></div>
      <p>Validando token...</p>
    </div>

    <!-- Error cuando el token no es válido -->
    <div class="error-section" *ngIf="!loading && !isValidToken">
      <div class="error-icon">⚠️</div>
      <div class="message error">{{ message }}</div>
      <button type="button" class="btn-secondary" (click)="goToLogin()">
        Volver al login
      </button>
    </div>

    <!-- Formulario de restablecimiento cuando el token es válido -->
    <div class="form-section" *ngIf="!loading && isValidToken">
      <p class="welcome-text">Hola <strong>{{ userName }}</strong>, ingresa tu nueva contraseña:</p>
      
      <form (ngSubmit)="onSubmit()" #resetForm="ngForm">
        <div class="form-group">
          <label for="newPassword">Nueva Contraseña</label>
          <input 
            id="newPassword"
            type="password" 
            [(ngModel)]="newPassword" 
            name="password"
            placeholder="Ingrese nueva contraseña"
            [disabled]="submitting"
            required
            minlength="6"
            class="form-input">
        </div>
        
        <div class="form-group">
          <label for="confirmPassword">Confirmar Contraseña</label>
          <input 
            id="confirmPassword"
            type="password" 
            [(ngModel)]="confirmPassword" 
            name="confirmPassword"
            placeholder="Confirme la nueva contraseña"
            [disabled]="submitting"
            required
            class="form-input">
        </div>
        
        <div class="button-group">
          <button 
            type="submit" 
            class="btn-primary"
            [disabled]="submitting || !resetForm.form.valid">
            <span *ngIf="!submitting">Actualizar Contraseña</span>
            <span *ngIf="submitting">
              <div class="loading-spinner-small"></div>
              Actualizando...
            </span>
          </button>
          
          <button 
            type="button" 
            class="btn-secondary" 
            (click)="goToLogin()" 
            [disabled]="submitting">
            Cancelar
          </button>
        </div>
      </form>
    </div>
    
    <!-- Mensajes de éxito o error -->
    <div *ngIf="message && isValidToken" [class]="'message ' + messageType">
      {{ message }}
    </div>
  </div>
</div>
