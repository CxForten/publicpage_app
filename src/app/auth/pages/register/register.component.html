<div class="login-wrapper">
  <div class="login-left">
    <div class="logo-container">
      <div class="logo-wrapper" (click)="goHome()">
        <img src="assets/icons/gaia.png" alt="Gaia Logo" class="gaia-logo"/>
        <div class="logo-glow"></div>
      </div>
      <div class="floating-elements">
        <ng-container *ngFor="let _ of floatElements; let idx = index">
          <div class="float-element" [ngClass]="'element-' + (idx + 1)"></div>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="login-right">
    <div class="login-box">
      <h2>Crear una cuenta</h2>

      <!-- Mensajes de error y éxito -->
      <div *ngIf="mostrandoMensaje" class="message-container">
        <div *ngIf="mensajeError" class="message message-error">
          <div class="message-icon">⚠️</div>
          <div class="message-content">
            <div *ngFor="let linea of getMensajeErrorLineas()">{{ linea }}</div>
          </div>
          <button type="button" class="message-close" (click)="ocultarMensajes()">×</button>
        </div>
        
        <div *ngIf="mensajeExito" class="message message-success">
          <div class="message-icon">✅</div>
          <div class="message-content">
            <span>{{ mensajeExito }}</span>
          </div>
          <button type="button" class="message-close" (click)="ocultarMensajes()">×</button>
        </div>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="registrar()">
        <div class="form-group">
          <label for="cedula">Cédula</label>
          <div class="form-row">
            <input id="cedula" 
                   formControlName="cedula" 
                   placeholder="Cédula"
                   [class.error-field]="hasFieldError('cedula')"/>
            <button type="button" (click)="validarCedula()" class="btn-login" [disabled]="validandoCedula">
              {{ validandoCedula ? 'Validando...' : 'Validar' }}
            </button>
          </div>
          <span *ngIf="hasFieldError('cedula')" 
                class="field-error" 
                style="color: #dc2626 !important; font-size: 0.75rem; font-weight: 500; margin-top: 0.25rem; display: block;">
            {{ getFieldErrorMessage('cedula') }}
          </span>
        </div>

        <div class="form-group">
          <label for="nombres_completos">Nombres y Apellidos</label>
          <input id="nombres_completos" 
                 formControlName="nombres_completos" 
                 placeholder="Nombres y Apellidos" 
                 readonly
                 [class.error-field]="hasFieldError('nombres_completos')"/>
          <div *ngIf="hasFieldError('nombres_completos')" 
               style="color: red; font-size: 12px; font-weight: 500; margin-top: 4px; display: block;">
            {{ getFieldErrorMessage('nombres_completos') }}
          </div>
        </div>

        <div class="form-group">
          <label for="correo">Correo electrónico</label>
          <input id="correo" 
                 formControlName="correo" 
                 placeholder="Correo electrónico"
                 [class.error-field]="hasFieldError('correo')"/>
          <span *ngIf="hasFieldError('correo')" 
                class="field-error"
                style="color: #dc2626 !important; font-size: 0.75rem; font-weight: 500; margin-top: 0.25rem; display: block;">
            {{ getFieldErrorMessage('correo') }}
          </span>
        </div>

        <div class="form-group">
          <label for="contraseña">Contraseña</label>
          <input id="contraseña" 
                 type="password" 
                 formControlName="contraseña" 
                 placeholder="Contraseña"
                 [class.error-field]="hasFieldError('contraseña')"/>
          <span *ngIf="hasFieldError('contraseña')" 
                class="field-error"
                style="color: #dc2626 !important; font-size: 0.75rem; font-weight: 500; margin-top: 0.25rem; display: block;">
            {{ getFieldErrorMessage('contraseña') }}
          </span>
        </div>

        <div class="form-group">
          <label for="confirmar">Confirmar contraseña</label>
          <input id="confirmar" 
                 type="password" 
                 formControlName="confirmar" 
                 placeholder="Confirmar contraseña"
                 [class.error-field]="hasFieldError('confirmar')"/>
          <span *ngIf="hasFieldError('confirmar')" 
                class="field-error"
                style="color: #dc2626 !important; font-size: 0.75rem; font-weight: 500; margin-top: 0.25rem; display: block;">
            {{ getFieldErrorMessage('confirmar') }}
          </span>
        </div>

        <div class="form-group">
          <label class="toggle-title" (click)="mostrarEmpresa = !mostrarEmpresa">
            Información de la empresa (opcional)
            <span class="arrow" [class.open]="mostrarEmpresa">▼</span>
          </label>
          <div *ngIf="mostrarEmpresa" class="empresa-form" [@slideIn]>
            <div class="form-group" style="--index: 0;">
              <label for="nombre_empresa">Nombre Empresa</label>
              <input id="nombre_empresa" 
                     formControlName="nombre_empresa" 
                     placeholder="Nombre Empresa"
                     [class.error-field]="hasFieldError('nombre_empresa')"/>
              <span *ngIf="hasFieldError('nombre_empresa')" class="field-error">
                {{ getFieldErrorMessage('nombre_empresa') }}
              </span>
            </div>
            <div class="form-group" style="--index: 1;">
              <label for="ruc">RUC</label>
              <input id="ruc" 
                     formControlName="ruc" 
                     placeholder="RUC"
                     [class.error-field]="hasFieldError('ruc')"/>
              <span *ngIf="hasFieldError('ruc')" class="field-error">
                {{ getFieldErrorMessage('ruc') }}
              </span>
            </div>
            <div class="form-group" style="--index: 2;">
              <label for="correo_empresarial">Correo empresarial</label>
              <input id="correo_empresarial" 
                     formControlName="correo_empresarial" 
                     placeholder="Correo empresarial"
                     [class.error-field]="hasFieldError('correo_empresarial')"/>
              <span *ngIf="hasFieldError('correo_empresarial')" class="field-error">
                {{ getFieldErrorMessage('correo_empresarial') }}
              </span>
            </div>
            <div class="form-group" style="--index: 3;">
              <label for="cargo">Cargo</label>
              <input id="cargo" 
                     formControlName="cargo" 
                     placeholder="Cargo"
                     [class.error-field]="hasFieldError('cargo')"/>
              <span *ngIf="hasFieldError('cargo')" class="field-error">
                {{ getFieldErrorMessage('cargo') }}
              </span>
            </div>
          </div>
        </div>

        <div class="form-group checkbox-container" [class.has-error]="hasFieldError('terminos')">
          <input type="checkbox" 
                 formControlName="terminos"
                 [class.error-field]="hasFieldError('terminos')" />
          <label>
            <span>
              Acepto los <a (click)="openTermsModal()" style="cursor: pointer;">términos y condiciones</a>
            </span>
          </label>
          <span *ngIf="hasFieldError('terminos')" 
                class="field-error" 
                style="color: #dc2626 !important; font-size: 0.75rem; font-weight: 500; display: block; margin-top: 0.5rem;">
            {{ getFieldErrorMessage('terminos') }}
          </span>
        </div>

        <button type="submit" class="btn-login">Crear cuenta</button>
      </form>

      <p class="register-text">
        ¿Ya tienes una cuenta?
        <a routerLink="/auth/login">Iniciar sesión</a>
      </p>
    </div>
  </div>
</div>


<div class="modal-overlay" *ngIf="showTermsModal" (click)="closeTermsModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Términos y Condiciones</h3>
      <button class="close-btn" (click)="closeTermsModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="terms-content">
        <h4>1. Aceptación de Términos</h4>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Cum ipsum eligendi ab similique dolor adipisci, quia blanditiis natus veniam. Sed ad tempora repudiandae ea blanditiis fugiat recusandae reprehenderit, quia consequuntur?</p>

      </div>
    </div>
  </div>
</div>
